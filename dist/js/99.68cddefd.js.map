{"version":3,"file":"js/99.68cddefd.js","mappings":"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","sources":["webpack://cqxt-manage/./src/enum/router-name.ts","webpack://cqxt-manage/./src/enum/validate.ts","webpack://cqxt-manage/./src/mixins/mixins.ts","webpack://cqxt-manage/./src/views/signin.vue?3577","webpack://cqxt-manage/./src/views/signin.vue","webpack://cqxt-manage/./src/views/signin.vue?c5ba"],"sourcesContent":["export const enum RouterName {\r\n    Error = \"/404\",\r\n    Signin = \"/sign-in\",\r\n    SignUp = \"/sign-up\",\r\n    Cqxtcontainer = \"/\",\r\n    MySpace = \"/my-space\"\r\n}","import { HttpManager } from \"@/API\";\r\nimport { proxyRefs } from \"vue\";\r\n\r\nexport const valiusername=(rule, value, callback)=>{\r\n    if (!value) {\r\n        return callback(new Error(\"账号不能为空\"));\r\n    } else {\r\n         callback();\r\n    }\r\n}\r\n\r\nexport const valipassword=(rule, value, callback)=>{\r\n    if (!value) {\r\n        return callback(new Error(\"密码不能为空\"));\r\n    } else {\r\n        callback();\r\n    }\r\n}\r\n//登入规则\r\nexport const SigninRules = {\r\n        username: [{ validator: valiusername, trigger: 'blur' }],\r\n        password: [{ validator: valipassword, trigger: 'change' }]\r\n}\r\n\r\n//注册规则\r\n/* export const valiemail = (rule, value, callback)=>{\r\n    if (!value) {\r\n        return callback(new Error(\"邮箱不能为空\"));\r\n    }\r\n    if(value == \"/[]\"){\r\n\r\n    }\r\n} */\r\nexport const valiusernames = async (rule, value, callback)=>{\r\n    if (!value) {\r\n        return callback(new Error(\"账号不能为空\"));\r\n    } \r\n    const username = value\r\n    const result = (await HttpManager.checkUsername(username)) as ResponseBody;\r\n    if (!result.success) {\r\n        return callback(new Error(\"该账号已被他人使用\"));\r\n    }else {\r\n        callback();\r\n    }\r\n\r\n}\r\n\r\nexport const valiemail = async (rule, value, callback)=>{\r\n    if (!value) {\r\n        return callback(new Error(\"账号不能为空\"));\r\n    } \r\n    const email = value\r\n    const result = (await HttpManager.checkEmail(email)) as ResponseBody;\r\n    if (!result.success) {\r\n        return callback(new Error(\"该邮箱已被使用\"));\r\n    }else {\r\n        callback();\r\n    }\r\n\r\n}\r\n\r\nexport const SignupRules = {\r\n    email: [\r\n        {\r\n        validator: valiemail,\r\n        required: true,\r\n        trigger: 'blur',\r\n        },\r\n        {\r\n        type: 'email',\r\n        message: '请输入正确的emali',\r\n        trigger: ['blur', 'change'],\r\n        },\r\n    ],\r\n    name: [\r\n        { required: true, trigger: 'blur', message: '请输入名字' },\r\n        {min: 3, max: 16, message: '名字格式不对', trigger: 'blur'}\r\n    ],\r\n    username: [\r\n        { validator: valiusernames, required: true, trigger: 'blur' },\r\n        {min: 8, max: 16, message: '账号应该在8-16位数之间', trigger: 'blur'}\r\n    ],\r\n    password: [\r\n        { message: '密码不能为空', required: true, trigger: 'blur' },\r\n        {min: 8, max: 16, message: '密码应该在8-16位数之间', trigger: 'blur'}\r\n    ]\r\n}\r\n\r\n\r\n","import  {RouterName}  from \"@/enum/router-name\";\r\nimport {useStore} from \"vuex\";\r\nimport { computed, getCurrentInstance } from \"vue\";\r\nimport { LocationQueryRaw } from \"vue-router\";\r\n\r\ninterface routerOptions {\r\n    path?: string;\r\n    query?: LocationQueryRaw;\r\n}\r\n\r\nexport default function () {\r\n    const { proxy } = getCurrentInstance();\r\n  \r\n    const store = useStore();\r\n    const token = computed(() => store.getters.token);\r\n    \r\n    // 导航索引\r\n    /* function changeIndex(value) {\r\n        proxy.$store.commit(\"setActiveNavName\", value);\r\n    } */\r\n\r\n    // 路由管理\r\n    function routerManager(routerName: string | number, options: routerOptions) {\r\n        switch (routerName) {\r\n        case RouterName.SignUp:\r\n        case RouterName.Error:\r\n        default:\r\n            proxy.$router.push({ path: options.path });\r\n            break;\r\n        }\r\n  }\r\n  return{\r\n    routerManager,\r\n  }\r\n}    \r\n","import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"signin\" }\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"header\", null, \"登入\", -1)\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_el_input = _resolveComponent(\"el-input\")!\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _hoisted_2,\n    _createVNode(_component_el_form, {\n      model: _ctx.user,\n      \"status-icon\": \"\",\n      rules: _ctx.SigninRules,\n      ref: \"userref\",\n      \"lable-width\": \"100px\",\n      class: \"signin-ruleform\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_el_form_item, {\n          label: \"账号\",\n          prop: \"username\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_el_input, {\n              placeholder: \"请输入账号\",\n              modelValue: _ctx.user.username,\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.user.username) = $event)),\n              clearable: \"\",\n              style: {\"width\":\"200px\"}\n            }, null, 8, [\"modelValue\"])\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_el_form_item, {\n          label: \"密码\",\n          prop: \"password\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_el_input, {\n              placeholder: \"请输入密码\",\n              modelValue: _ctx.user.password,\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.user.password) = $event)),\n              \"show-password\": \"\",\n              style: {\"width\":\"200px\"}\n            }, null, 8, [\"modelValue\"])\n          ]),\n          _: 1\n        }),\n        _createVNode(_component_el_form_item, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_el_button, {\n              type: \"primary\",\n              onClick: _cache[2] || (_cache[2] = ($event: any) => (_ctx.signin())),\n              color: \"#626aef\",\n              dark: _ctx.isDark\n            }, {\n              default: _withCtx(() => [\n                _createTextVNode(\"登入\")\n              ]),\n              _: 1\n            }, 8, [\"dark\"]),\n            _createVNode(_component_el_button, {\n              type: \"primary\",\n              onClick: _cache[3] || (_cache[3] = ($event: any) => (_ctx.loginin())),\n              color: \"#626aef\",\n              dark: _ctx.isDark\n            }, {\n              default: _withCtx(() => [\n                _createTextVNode(\"注册\")\n              ]),\n              _: 1\n            }, 8, [\"dark\"])\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"model\", \"rules\"])\n  ]))\n}","<template>\n    <div class=\"signin\">\n        <header>登入</header>\n            <el-form :model=\"user\" status-icon :rules=\"SigninRules\" ref=\"userref\" lable-width=\"100px\" class=\"signin-ruleform\">\n                <el-form-item label=\"账号\" prop=\"username\">\n                    <el-input placeholder=\"请输入账号\" v-model=\"user.username\" clearable style=\"width: 200px\"/>\n                </el-form-item>\n                <el-form-item label=\"密码\" prop=\"password\">\n                    <el-input placeholder=\"请输入密码\" v-model=\"user.password\" show-password style=\"width: 200px\"/>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"signin()\" color=\"#626aef\" :dark=\"isDark\">登入</el-button>\n                    <el-button type=\"primary\" @click=\"loginin()\" color=\"#626aef\" :dark=\"isDark\">注册</el-button>\n                </el-form-item>\n            </el-form>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, getCurrentInstance, reactive } from 'vue';\nimport { SigninRules } from \"@/enum/validate\"\nimport { HttpManager } from '@/API';\nimport mixin from '@/mixins/mixins';\nimport {RouterName} from \"@/enum/router-name\"\nimport { ElMessage } from 'element-plus';\nimport { useStore } from 'vuex';\n    export default defineComponent({\n        name: 'signin',\n        setup(){\n            const store = useStore()\n            const {proxy} = getCurrentInstance();\n            const{routerManager} = mixin();\n            const user = reactive({\n                username:\"\",\n                password:\"\"\n            })\n            async function signin(){\n            try {\n                const valid = await (proxy.$refs[\"userref\"] as any).validate();\n                const username = user.username;\n                const password = user.password;\n                const result = (await HttpManager.Signin(username, password)) as ResponseBody;\n                /* (proxy as any).$massage({\n                type : result.type,\n                }) */\n                if (result.success) {\n\n                    //console.log(result.message)\n                    console.log(result.data.id);\n                    \n                    store.commit(\"setUserId\", result.data.id);\n                    store.commit(\"setUsername\", result.data.username);\n                    store.commit(\"setUserPic\", result.data.avator);\n                    store.commit(\"setToken\", true);\n                    //后面在后端代码中生成token，现在先用id代替，可能有安全风险，但问题不大好吧\n                    localStorage.setItem('token', result.data.id)\n                    \n                    ElMessage.success(result.message);\n                    routerManager(RouterName.Cqxtcontainer, {path: RouterName.Cqxtcontainer})\n                }else{\n                    //console.log(result.message)\n                    ElMessage.error(result.message)\n                }\n            } catch (error) {\n                console.error(error) \n            }\n            \n            }\n\n            function loginin() {\n                routerManager(RouterName.SignUp, {path: RouterName.SignUp});\n            }\n\n            return{\n                user,\n                signin,\n                loginin,\n                SigninRules,\n            }\n        },\n\n    })\n    \n</script>","import { render } from \"./signin.vue?vue&type=template&id=6d3761bf&ts=true\"\nimport script from \"./signin.vue?vue&type=script&lang=ts\"\nexport * from \"./signin.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["RouterName","valiusername","rule","value","callback","Error","valipassword","SigninRules","username","validator","trigger","password","valiusernames","async","result","HttpManager","checkUsername","success","valiemail","email","checkEmail","SignupRules","required","type","message","name","min","max","proxy","getCurrentInstance","store","useStore","computed","getters","token","routerManager","routerName","options","SignUp","$router","push","path","_hoisted_1","class","_hoisted_2","_createElementVNode","render","_ctx","_cache","$props","$setup","$data","$options","_component_el_input","_resolveComponent","_component_el_form_item","_component_el_button","_component_el_form","_openBlock","_createElementBlock","_createVNode","model","user","rules","ref","default","_withCtx","label","prop","placeholder","modelValue","$event","clearable","style","_","onClick","signin","color","dark","isDark","_createTextVNode","loginin","defineComponent","setup","mixin","reactive","$refs","validate","Signin","console","log","data","id","commit","avator","localStorage","setItem","ElMessage","Cqxtcontainer","error","__exports__"],"sourceRoot":""}